{% comment %}
  Cart Page Template for TrendifyShop
{% endcomment %}

<div class="cart-page section-padding">
  <div class="page-width">
    <header class="cart-header">
      <h1 class="cart__title">{{ 'sections.cart.title' | t }}</h1>
    </header>

    {% if cart == empty %}
      <div class="cart-empty text-center">
        <h2>{{ 'sections.cart.empty' | t }}</h2>
        <p>{{ 'sections.cart.empty_text' | t }}</p>
        <a href="{{ routes.all_products_collection_url }}" class="btn btn--primary btn--large">
          {{ 'general.continue_shopping' | t }}
        </a>
      </div>
    {% else %}
      <div class="cart-items">
        <form action="{{ routes.cart_url }}" method="post" novalidate class="cart">
          <div class="cart__items">
            {% for item in cart.items %}
              <div class="cart-item">
                <div class="cart-item__media">
                  {% if item.image %}
                    <img src="{{ item.image | image_url: width: 120 }}" 
                         alt="{{ item.image.alt | escape }}"
                         loading="lazy"
                         width="120"
                         height="120">
                  {% endif %}
                </div>
                
                <div class="cart-item__details">
                  <h3 class="cart-item__name">
                    <a href="{{ item.url }}">{{ item.product.title }}</a>
                  </h3>
                  
                  {% unless item.product.has_only_default_variant %}
                    <p class="cart-item__variant">{{ item.variant.title }}</p>
                  {% endunless %}
                  
                  <div class="cart-item__price price">
                    <span class="price__current">{{ item.price | money }}</span>
                    {% if item.original_price != item.final_price %}
                      <span class="price__compare">{{ item.original_price | money }}</span>
                    {% endif %}
                  </div>
                </div>
                
                <div class="cart-item__quantity">
                  <label for="Quantity-{{ item.index | plus: 1 }}" class="visually-hidden">
                    {{ 'products.product.quantity' | t }}
                  </label>
                  <div class="quantity">
                    <button type="button" class="quantity__button" data-quantity-button="decrease">
                      <span class="visually-hidden">{{ 'products.product.quantity.decrease' | t: product: item.product.title | escape }}</span>
                      -
                    </button>
                    <input class="quantity__input" 
                           type="number" 
                           name="updates[]" 
                           value="{{ item.quantity }}" 
                           min="0" 
                           id="Quantity-{{ item.index | plus: 1 }}">
                    <button type="button" class="quantity__button" data-quantity-button="increase">
                      <span class="visually-hidden">{{ 'products.product.quantity.increase' | t: product: item.product.title | escape }}</span>
                      +
                    </button>
                  </div>
                </div>
                
                <div class="cart-item__totals">
                  <div class="cart-item__price-wrapper price">
                    <span class="price__current">{{ item.line_price | money }}</span>
                  </div>
                  
                  <a href="{{ item.url_to_remove }}" class="cart-item__remove" aria-label="Remove {{ item.product.title | escape }}">
                    Remove
                  </a>
                </div>
              </div>
            {% endfor %}
          </div>
          
          <div class="cart__footer">
            <div class="cart__buttons">
              <button type="submit" name="update" class="btn btn--outline">
                {{ 'sections.cart.update' | t }}
              </button>
              <button type="submit" name="clear" class="btn btn--outline" formaction="{{ routes.cart_clear_url }}">
                {{ 'sections.cart.clear' | t }}
              </button>
            </div>
            
            <div class="cart__totals">
              <div class="totals">
                <h3 class="totals__subtotal">
                  {{ 'sections.cart.subtotal' | t }}: 
                  <span class="totals__subtotal-value">{{ cart.total_price | money }}</span>
                </h3>
                <p class="cart__tax-note">
                  {{ 'sections.cart.taxes_and_shipping_policy_at_checkout_html' | t: link: policies.refund_policy.url }}
                </p>
                
                <div class="cart__ctas">
                  <button type="submit" name="add" class="btn btn--primary btn--large btn--full-width cart__checkout-button">
                    {{ 'sections.cart.checkout' | t }}
                  </button>
                </div>
              </div>
            </div>
          </div>
        </form>
      </div>
    {% endif %}
  </div>
</div>

<style>
.cart-header {
  text-align: center;
  margin-bottom: 3rem;
}

.cart-empty {
  padding: 4rem 0;
}

.cart-empty h2 {
  margin-bottom: 1rem;
}

.cart-empty p {
  margin-bottom: 2rem;
  color: var(--color-base-text-light);
}

.cart__items {
  margin-bottom: 2rem;
}

.cart-item {
  display: grid;
  grid-template-columns: 120px 1fr auto auto;
  gap: 1rem;
  padding: 1.5rem 0;
  border-bottom: var(--border-width) solid rgba(var(--color-base-outline-button), var(--border-opacity));
  align-items: center;
}

.cart-item__media img {
  width: 100%;
  height: auto;
  border-radius: var(--border-radius);
}

.cart-item__name a {
  color: var(--color-base-accent);
  text-decoration: none;
  font-weight: var(--font-body-weight-bold);
}

.cart-item__name a:hover {
  color: var(--color-primary);
}

.cart-item__variant {
  color: var(--color-base-text-light);
  font-size: 0.875rem;
  margin: 0.5rem 0;
}

.quantity {
  display: flex;
  align-items: center;
  border: var(--border-width) solid var(--color-base-outline-button);
  border-radius: var(--border-radius);
  overflow: hidden;
}

.quantity__button {
  background: none;
  border: none;
  padding: 8px 12px;
  cursor: pointer;
  font-size: 1.125rem;
  transition: var(--animation-default);
}

.quantity__button:hover {
  background-color: var(--color-base-background-alt);
}

.quantity__input {
  border: none;
  text-align: center;
  width: 60px;
  padding: 8px 4px;
  font-size: 1rem;
}

.cart-item__totals {
  text-align: right;
}

.cart-item__remove {
  color: var(--color-base-text-light);
  text-decoration: underline;
  font-size: 0.875rem;
  margin-top: 0.5rem;
  display: inline-block;
}

.cart-item__remove:hover {
  color: var(--color-accent);
}

.cart__footer {
  display: flex;
  justify-content: space-between;
  align-items: flex-end;
  padding-top: 2rem;
  border-top: var(--border-width) solid rgba(var(--color-base-outline-button), var(--border-opacity));
}

.cart__buttons {
  display: flex;
  gap: 1rem;
}

.cart__totals {
  text-align: right;
}

.totals__subtotal {
  font-size: 1.5rem;
  margin-bottom: 1rem;
}

.totals__subtotal-value {
  color: var(--color-primary);
}

.cart__tax-note {
  font-size: 0.875rem;
  color: var(--color-base-text-light);
  margin-bottom: 2rem;
}

.cart__checkout-button {
  min-width: 200px;
}

@media screen and (max-width: 767px) {
  .cart-item {
    grid-template-columns: 80px 1fr;
    grid-template-areas: 
      "media details"
      "quantity totals";
    gap: 1rem 0.75rem;
  }
  
  .cart-item__media {
    grid-area: media;
  }
  
  .cart-item__details {
    grid-area: details;
  }
  
  .cart-item__quantity {
    grid-area: quantity;
    justify-self: start;
  }
  
  .cart-item__totals {
    grid-area: totals;
    text-align: right;
  }
  
  .cart__footer {
    flex-direction: column;
    gap: 2rem;
    align-items: stretch;
  }
  
  .cart__buttons {
    order: 2;
  }
  
  .cart__checkout-button {
    min-width: auto;
  }
}
</style>